"use strict";(self.webpackChunkinventory_web=self.webpackChunkinventory_web||[]).push([[701],{2701:function(n,t,o){o.r(t),o.d(t,{AddCompraModule:function(){return b}});var e=o(8583),i=o(9976),r=o(7120),c=o(7501),d=o(4619),p=o(4294),a=o(1945),u=o(639),g=o(5855),l=o(3534),s=o(2385),m=o(9625),f=o(1072),M=o(665),C=o(9577);function h(n,t){if(1&n&&(u.TgZ(0,"option",15),u._uU(1),u.qZA()),2&n){const n=t.$implicit;u.s9C("value",n.id),u.xp6(1),u.Oqu(n.name)}}function _(n,t){if(1&n&&(u.TgZ(0,"option",15),u._uU(1),u.qZA()),2&n){const n=t.$implicit;u.s9C("value",n.id),u.xp6(1),u.Oqu(n.name)}}function x(n,t){if(1&n){const n=u.EpF();u.TgZ(0,"fa-icon",24),u.NdJ("click",function(){u.CHM(n);const t=u.oxw(),o=t.$implicit,e=t.index;return u.oxw().removeProd(o,e)}),u.qZA()}if(2&n){const n=u.oxw(2);u.Q6J("icon",n.faMinus)}}function P(n,t){if(1&n&&(u.TgZ(0,"option",15),u._uU(1),u.qZA()),2&n){const n=t.$implicit;u.s9C("value",n.id),u.xp6(1),u.Oqu(n.name)}}function Z(n,t){if(1&n){const n=u.EpF();u.TgZ(0,"div",25),u.TgZ(1,"div",3),u.TgZ(2,"label"),u._uU(3,"Nome do Produto"),u.qZA(),u.TgZ(4,"input",26),u.NdJ("ngModelChange",function(t){return u.CHM(n),u.oxw().$implicit.produto.name=t}),u.qZA(),u.qZA(),u.TgZ(5,"div",3),u.TgZ(6,"label"),u._uU(7,"Categoria"),u.qZA(),u.TgZ(8,"select",27),u.NdJ("ngModelChange",function(t){return u.CHM(n),u.oxw().$implicit.produto.categoryId=t}),u.YNc(9,P,2,2,"option",5),u.qZA(),u.qZA(),u.TgZ(10,"div",28),u.TgZ(11,"div",29),u.TgZ(12,"div",3),u.TgZ(13,"label"),u._uU(14,"Pre\xe7o"),u.qZA(),u.TgZ(15,"div",30),u.TgZ(16,"span"),u._uU(17,"R$"),u.qZA(),u.TgZ(18,"input",31),u.NdJ("ngModelChange",function(t){return u.CHM(n),u.oxw().$implicit.produto.price=t}),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&n){const n=u.oxw(),t=n.index,o=n.$implicit,e=u.oxw();u.xp6(4),u.MGl("id","name_",t,""),u.MGl("name","name_",t,""),u.Q6J("ngModel",o.produto.name),u.xp6(4),u.MGl("id","cat2_",t,""),u.MGl("name","cat2_",t,""),u.Q6J("ngModel",o.produto.categoryId),u.xp6(1),u.Q6J("ngForOf",e.categorias),u.xp6(9),u.MGl("id","price2_",t,""),u.MGl("name","price2__",t,""),u.Q6J("ngModel",o.produto.price)}}function O(n,t){if(1&n){const n=u.EpF();u.TgZ(0,"div",16),u.TgZ(1,"div",17),u.TgZ(2,"div",3),u.TgZ(3,"label"),u._uU(4,"Produto"),u.qZA(),u.TgZ(5,"select",18),u.NdJ("ngModelChange",function(t){return u.CHM(n).$implicit.productId=t})("change",function(){const t=u.CHM(n).$implicit;return u.oxw().qtdChanged(t)}),u.YNc(6,_,2,2,"option",5),u.TgZ(7,"option",19),u._uU(8,"Novo Produto"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(9,"div",3),u.TgZ(10,"label"),u._uU(11,"Quantidade"),u.qZA(),u.TgZ(12,"input",20),u.NdJ("change",function(){const t=u.CHM(n).$implicit;return u.oxw().qtdChanged(t)})("ngModelChange",function(t){return u.CHM(n).$implicit.quantity=t}),u.qZA(),u.qZA(),u.TgZ(13,"div",3),u.TgZ(14,"label"),u._uU(15,"Pre\xe7o"),u.qZA(),u.TgZ(16,"span",21),u._uU(17),u.ALo(18,"currency"),u.qZA(),u.qZA(),u.YNc(19,x,1,1,"fa-icon",22),u.qZA(),u.YNc(20,Z,19,10,"div",23),u.qZA()}if(2&n){const n=t.$implicit,o=t.index,e=u.oxw();u.xp6(5),u.MGl("id","cat_",o,""),u.MGl("name","cat_",o,""),u.Q6J("ngModel",n.productId),u.xp6(1),u.Q6J("ngForOf",e.produtos),u.xp6(6),u.MGl("id","qtd_",o,""),u.MGl("name","qtd_",o,""),u.Q6J("ngModel",n.quantity),u.xp6(5),u.Oqu(u.xi3(18,10,n.price,"BRL")),u.xp6(2),u.Q6J("ngIf",0!=o),u.xp6(1),u.Q6J("ngIf",99999==n.productId&&n.produto)}}let v=(()=>{class n{constructor(n,t,o,e,r){this.router=n,this.compraService=t,this.fornecedorService=o,this.produtoService=e,this.categoriaService=r,this.faPlus=i.r8p,this.faMinus=i.Kl4,this.fornecedores=[],this.produtos=[],this.categorias=[],this.compra=new c.b}ngOnInit(){let n=new d.m;n.quantity=1,n.produto=new a.a,n.produto.price=0,n.produto.name="",this.compra.compraProdutos=[n],this.categoriaService.getCategorias().subscribe(n=>{this.categorias=n.map(n=>{let t=new r.E;return t.id=n.id,t.name=n.name,t})}),this.fornecedorService.getFornecedores().subscribe(n=>{this.fornecedores=n.map(n=>{let t=new p.u;return t.id=n.id,t.name=n.name,t})}),this.produtoService.getProdutos().subscribe(n=>{this.produtos=n.map(n=>{let t=new a.a;return t.id=n.id,t.name=n.name,t.price=n.price,t})})}removeProd(n,t){var o;this.compra.compraProdutos=null===(o=this.compra.compraProdutos)||void 0===o?void 0:o.filter((n,o)=>o!=t)}addProduto(){var n;let t=new d.m;t.quantity=1,t.produto=new a.a,t.produto.price=0,t.produto.name="",null===(n=this.compra.compraProdutos)||void 0===n||n.push(t)}submit(){var n;if(0==this.compra.providerId||null==this.compra.providerId)alert("Preencha todos os campos");else{let o={};o.providerId=this.compra.providerId,o.products=[];var t=!1;if(null===(n=this.compra.compraProdutos)||void 0===n||n.map(n=>{var e,i,r;(null!=n.quantity&&null!=n.quantity&&n.quantity<=0||!n.productId&&null!=n.produto&&null!=n.produto&&null!=n.produto.price&&null!=n.produto.price&&n.produto.price<=0)&&(t=!0),o.products.push({id:n.productId,quantity:n.quantity,name:null===(e=n.produto)||void 0===e?void 0:e.name,categoryId:null===(i=n.produto)||void 0===i?void 0:i.categoryId,price:null===(r=n.produto)||void 0===r?void 0:r.price})}),t)return void alert("Insira valores maiores que zero");this.compraService.criarCompra(o).subscribe(n=>{alert("Compra Cadastrada com sucesso"),this.router.navigate(["/compras"])},n=>{401==n.status?(alert("Sess\xe3o expirada"),this.router.navigate(["/login"])):"PRODUCT_NOT_FOUND"==n.error.error?alert("Produto Incorreto"):"INVALID_QUANTITY"==n.error.error?alert("Quantidade excede estoque dispon\xedvel"):alert(JSON.stringify(n.error))})}}qtdChanged(n){var t;if(n.productId&&null!=n.quantity&&null!=n.quantity){if(n.quantity<=0)return void alert("Insira valores maiores que zero");if(99999==n.productId&&n.produto&&n.produto.price)n.price=n.produto.price*n.quantity;else{let t=this.produtos.find(t=>t.id==parseInt(n.productId+""));t&&t.price&&(n.price=(null==t?void 0:t.price)*n.quantity)}}else n.price=0;let o=0;null===(t=this.compra.compraProdutos)||void 0===t||t.forEach(n=>{n.price&&(o+=n.price)}),this.compra.finalPrice=o}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(g.F0),u.Y36(l.L),u.Y36(s.p),u.Y36(m.m),u.Y36(f.n))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-add-compra"]],decls:26,vars:8,consts:[[1,"container"],[1,"title"],["role","form","name","produtoForm","novalidate","novalidate","data-parsley-priority-enabled","false","method","post","autocomplete","off"],[1,"formGroup"],["id","cat","name","cat",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"sub-title"],[1,"prodcutsWp"],["class","products formGroup2",4,"ngFor","ngForOf"],[1,"total"],[1,"btnDiv","btnDivAdd"],["type","button",1,"btnSubmit",3,"click"],[3,"icon"],[1,"btnDiv"],["type","submit",1,"btnSubmit",3,"click"],[3,"value"],[1,"products","formGroup2"],[1,"firstLine"],[3,"ngModel","id","name","ngModelChange","change"],["value","99999"],["type","number","min","1",3,"ngModel","id","name","change","ngModelChange"],[1,"vpPrice"],["class","removeProd",3,"icon","click",4,"ngIf"],["class","secondLine",4,"ngIf"],[1,"removeProd",3,"icon","click"],[1,"secondLine"],["type","text",3,"ngModel","id","name","ngModelChange"],[3,"ngModel","id","name","ngModelChange"],[1,"formGroup2"],[1,"column"],[1,"formGroupMoney"],["type","number","min","0.1",3,"ngModel","id","name","ngModelChange"]],template:function(n,t){1&n&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"h1"),u._uU(3,"ADICIONAR COMPRA"),u.qZA(),u.qZA(),u.TgZ(4,"form",2),u.TgZ(5,"div",3),u.TgZ(6,"label"),u._uU(7,"Fornecedor"),u.qZA(),u.TgZ(8,"select",4),u.NdJ("ngModelChange",function(n){return t.compra.providerId=n}),u.YNc(9,h,2,2,"option",5),u.qZA(),u.qZA(),u.TgZ(10,"div",6),u.TgZ(11,"h1"),u._uU(12,"Produtos"),u.qZA(),u.qZA(),u.TgZ(13,"div",7),u.YNc(14,O,21,13,"div",8),u.TgZ(15,"div",9),u.TgZ(16,"b"),u._uU(17),u.ALo(18,"currency"),u.qZA(),u.qZA(),u.TgZ(19,"div",10),u.TgZ(20,"button",11),u.NdJ("click",function(){return t.addProduto()}),u._UZ(21,"fa-icon",12),u._uU(22," Adicionar Produto"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(23,"div",13),u.TgZ(24,"button",14),u.NdJ("click",function(){return t.submit()}),u._uU(25,"Cadastrar"),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&n&&(u.xp6(8),u.Q6J("ngModel",t.compra.providerId),u.xp6(1),u.Q6J("ngForOf",t.fornecedores),u.xp6(5),u.Q6J("ngForOf",t.compra.compraProdutos),u.xp6(3),u.hij("Total: ",u.xi3(18,5,t.compra.finalPrice,"BRL"),""),u.xp6(4),u.Q6J("icon",t.faPlus))},directives:[M._Y,M.JL,M.F,M.EJ,M.JJ,M.On,e.sg,C.BN,M.YN,M.Kr,M.qQ,M.wV,M.Fj,e.O5],pipes:[e.H9],styles:[".container[_ngcontent-%COMP%]{padding:30px}.container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;width:100%;background-color:#9364f1;padding:5px}.container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-size:25px;margin:10px 0}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{padding:50px;justify-content:center;display:flex;align-items:center;flex-direction:column}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:20px 0}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:bold;margin-bottom:10px;color:#534962}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background:#fff;width:340px;border-radius:15px;box-shadow:none;outline:none;border:1px solid #9671f1;font-size:16px;padding:15px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding-right:15px;width:370px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   .formGroupMoney[_ngcontent-%COMP%]{display:flex}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   .formGroupMoney[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border:1px solid #9671f1;height:48px;border-right:none;border-radius:15px 0 0 15px;display:flex;align-items:center;padding:0 15px;font-size:20px;color:#fff;background:#9671f1}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   .formGroupMoney[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100px;border-left:none;border-radius:0 15px 15px 0}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup2[_ngcontent-%COMP%]{display:flex;grid-column-gap:50px;-moz-column-gap:50px;column-gap:50px;flex-direction:column}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup2[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .btnDiv[_ngcontent-%COMP%]{display:flex;grid-column-gap:50px;-moz-column-gap:50px;column-gap:50px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .btnSubmit[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin-top:2rem;border:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;background:#ccd1ff;color:#5e17eb;border-radius:50px;font-size:20px;cursor:pointer;padding:16px 40px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .btnDelete[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin-top:2rem;border:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;background:#ff4646;color:#fff;border-radius:50px;font-size:20px;cursor:pointer;padding:16px 40px}.sub-title[_ngcontent-%COMP%]{text-align:center;width:50%;background-color:#9364f1;padding:5px;margin:30px auto 0}.sub-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-size:18px;margin:5px 0}.btnDivAdd[_ngcontent-%COMP%]{justify-content:end}.btnDivAdd[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:15px!important;padding:11px!important}.formGroup2[_ngcontent-%COMP%]{align-items:center}.removeProd[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin-top:2rem;border:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;background:#ccd1ff;color:#5e17eb;border-radius:50px;font-size:20px;cursor:pointer;font-size:15px;padding:13px}.vpPrice[_ngcontent-%COMP%]{height:50px;vertical-align:middle;line-height:50px;text-align:center}.total[_ngcontent-%COMP%]{text-align:right}.firstLine[_ngcontent-%COMP%], .secondLine[_ngcontent-%COMP%]{display:flex;grid-column-gap:50px;-moz-column-gap:50px;column-gap:50px}.firstLine[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .secondLine[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100px}"]}),n})(),b=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[s.p,m.m,l.L,f.n],imports:[[e.ez,g.Bz.forChild([{path:"",component:v}]),M.u5,C.uH]]}),n})()}}]);