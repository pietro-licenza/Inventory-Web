"use strict";(self.webpackChunkinventory_web=self.webpackChunkinventory_web||[]).push([[354],{9354:function(n,t,e){e.r(t),e.d(t,{AddOrcamentoModule:function(){return v}});var o=e(8583),i=e(9976),r=e(9598),c=e(1945),d=e(4188),a=e(7661),u=e(639),g=e(5855),p=e(6302),l=e(4930),s=e(9625),f=e(665),m=e(9577);function h(n,t){if(1&n&&(u.TgZ(0,"option",21),u._uU(1),u.qZA()),2&n){const n=t.$implicit;u.s9C("value",n.id),u.xp6(1),u.Oqu(n.name)}}function M(n,t){if(1&n&&(u.TgZ(0,"option",21),u._uU(1),u.qZA()),2&n){const n=t.$implicit;u.s9C("value",n.id),u.xp6(1),u.Oqu(n.name)}}function C(n,t){if(1&n){const n=u.EpF();u.TgZ(0,"fa-icon",27),u.NdJ("click",function(){u.CHM(n);const t=u.oxw(),e=t.$implicit,o=t.index;return u.oxw().removeProd(e,o)}),u.qZA()}if(2&n){const n=u.oxw(2);u.Q6J("icon",n.faMinus)}}function P(n,t){if(1&n){const n=u.EpF();u.TgZ(0,"div",22),u.TgZ(1,"div",3),u.TgZ(2,"label"),u._uU(3,"Produto"),u.qZA(),u.TgZ(4,"select",23),u.NdJ("ngModelChange",function(t){return u.CHM(n).$implicit.productId=t})("change",function(){const t=u.CHM(n).$implicit;return u.oxw().qtdChanged(t)}),u.YNc(5,M,2,2,"option",5),u.qZA(),u.qZA(),u.TgZ(6,"div",3),u.TgZ(7,"label"),u._uU(8,"Quantidade"),u.qZA(),u.TgZ(9,"input",24),u.NdJ("change",function(){const t=u.CHM(n).$implicit;return u.oxw().qtdChanged(t)})("ngModelChange",function(t){return u.CHM(n).$implicit.quantity=t}),u.qZA(),u.qZA(),u.TgZ(10,"div",3),u.TgZ(11,"label"),u._uU(12,"Pre\xe7o"),u.qZA(),u.TgZ(13,"span",25),u._uU(14),u.ALo(15,"currency"),u.qZA(),u.qZA(),u.YNc(16,C,1,1,"fa-icon",26),u.qZA()}if(2&n){const n=t.$implicit,e=t.index,o=u.oxw();u.xp6(4),u.MGl("id","cat_",e,""),u.MGl("name","cat_",e,""),u.Q6J("ngModel",n.productId),u.xp6(1),u.Q6J("ngForOf",o.produtos),u.xp6(4),u.MGl("id","qtd_",e,""),u.MGl("name","qtd_",e,""),u.Q6J("ngModel",n.quantity),u.xp6(5),u.Oqu(u.xi3(15,9,n.price,"BRL")),u.xp6(2),u.Q6J("ngIf",0!=e)}}let _=(()=>{class n{constructor(n,t,e,o){this.router=n,this.vendaService=t,this.clienteService=e,this.produtoService=o,this.faPlus=i.r8p,this.faMinus=i.Kl4,this.clientes=[],this.produtos=[],this.venda=new d.S}ngOnInit(){let n=new a.o;n.quantity=1,n.produto=new c.a,this.venda.vendaProdutos=[n],this.clienteService.getClientes().subscribe(n=>{this.clientes=n.map(n=>{let t=new r.c;return t.id=n.id,t.name=n.name,t})}),this.produtoService.getProdutos().subscribe(n=>{this.produtos=n.map(n=>{let t=new c.a;return t.id=n.id,t.name=n.name,t.price=n.price,t})})}removeProd(n,t){var e;this.venda.vendaProdutos=null===(e=this.venda.vendaProdutos)||void 0===e?void 0:e.filter((n,e)=>e!=t)}addProduto(){var n;let t=new a.o;t.quantity=1,null===(n=this.venda.vendaProdutos)||void 0===n||n.push(t)}submit(){var n;if(0==this.venda.clientId||null==this.venda.clientId||""==this.venda.paymentMethod||null==this.venda.paymentMethod)alert("Preencha todos os campos");else{let t={};t.clientId=this.venda.clientId,t.paymentMethod=this.venda.paymentMethod,t.products=[];let e=!1;if(null===(n=this.venda.vendaProdutos)||void 0===n||n.map(n=>{null!=n.quantity&&null!=n.quantity&&n.quantity<=0&&(e=!0),t.products.push({id:n.productId,quantity:n.quantity})}),e)return void alert("Insira valores maiores que zero");t.isSaleComplete=!1,this.vendaService.criarVenda(t).subscribe(n=>{alert("Or\xe7amento Cadastrado com sucesso"),this.router.navigate(["/orcamentos"])},n=>{401==n.status?(alert("Sess\xe3o expirada"),this.router.navigate(["/login"])):"PRODUCT_NOT_FOUND"==n.error.error?alert("Produto Incorreto"):"INVALID_QUANTITY"==n.error.error?alert("Quantidade excede estoque dispon\xedvel"):alert(JSON.stringify(n.error))})}}qtdChanged(n){var t;if(n.productId&&null!=n.quantity&&null!=n.quantity){if(n.quantity<=0)return void alert("Insira valores maiores que zero");let t=this.produtos.find(t=>t.id==parseInt(n.productId+""));t&&t.price&&(n.price=(null==t?void 0:t.price)*n.quantity,console.log(n.price))}else n.price=0;let e=0;null===(t=this.venda.vendaProdutos)||void 0===t||t.forEach(n=>{n.price&&(e+=n.price)}),this.venda.finalPrice=e}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(g.F0),u.Y36(p.O),u.Y36(l.$),u.Y36(s.m))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-add-orcamento"]],decls:40,vars:9,consts:[[1,"container"],[1,"title"],["role","form","name","produtoForm","novalidate","novalidate","data-parsley-priority-enabled","false","method","post","autocomplete","off"],[1,"formGroup"],["id","cat","name","cat",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","cat1","name","cat1",3,"ngModel","ngModelChange"],["value","CARTAO_CREDITO"],["value","CARTAO_DEBITO"],["value","BOLETO"],["value","PIX"],["value","Dinheiro"],[1,"sub-title"],[1,"prodcutsWp"],["class","products formGroup2",4,"ngFor","ngForOf"],[1,"total"],[1,"btnDiv","btnDivAdd"],["type","button",1,"btnSubmit",3,"click"],[3,"icon"],[1,"btnDiv"],["type","submit",1,"btnSubmit",3,"click"],[3,"value"],[1,"products","formGroup2"],[3,"ngModel","id","name","ngModelChange","change"],["type","number","min","1",3,"ngModel","id","name","change","ngModelChange"],[1,"vpPrice"],["class","removeProd",3,"icon","click",4,"ngIf"],[1,"removeProd",3,"icon","click"]],template:function(n,t){1&n&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"h1"),u._uU(3,"CRIAR OR\xc7AMENTO"),u.qZA(),u.qZA(),u.TgZ(4,"form",2),u.TgZ(5,"div",3),u.TgZ(6,"label"),u._uU(7,"Cliente"),u.qZA(),u.TgZ(8,"select",4),u.NdJ("ngModelChange",function(n){return t.venda.clientId=n}),u.YNc(9,h,2,2,"option",5),u.qZA(),u.qZA(),u.TgZ(10,"div",3),u.TgZ(11,"label"),u._uU(12,"M\xe9todo de Pagamento"),u.qZA(),u.TgZ(13,"select",6),u.NdJ("ngModelChange",function(n){return t.venda.paymentMethod=n}),u.TgZ(14,"option",7),u._uU(15,"Cart\xe3o de Cr\xe9dito"),u.qZA(),u.TgZ(16,"option",8),u._uU(17,"Cart\xe3o de D\xe9bito"),u.qZA(),u.TgZ(18,"option",9),u._uU(19,"Boleto"),u.qZA(),u.TgZ(20,"option",10),u._uU(21,"PIX"),u.qZA(),u.TgZ(22,"option",11),u._uU(23,"Dinheiro"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(24,"div",12),u.TgZ(25,"h1"),u._uU(26,"Produtos"),u.qZA(),u.qZA(),u.TgZ(27,"div",13),u.YNc(28,P,17,12,"div",14),u.TgZ(29,"div",15),u.TgZ(30,"b"),u._uU(31),u.ALo(32,"currency"),u.qZA(),u.qZA(),u.TgZ(33,"div",16),u.TgZ(34,"button",17),u.NdJ("click",function(){return t.addProduto()}),u._UZ(35,"fa-icon",18),u._uU(36," Adicionar Produto"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(37,"div",19),u.TgZ(38,"button",20),u.NdJ("click",function(){return t.submit()}),u._uU(39,"Cadastrar"),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&n&&(u.xp6(8),u.Q6J("ngModel",t.venda.clientId),u.xp6(1),u.Q6J("ngForOf",t.clientes),u.xp6(4),u.Q6J("ngModel",t.venda.paymentMethod),u.xp6(15),u.Q6J("ngForOf",t.venda.vendaProdutos),u.xp6(3),u.hij("Total: ",u.xi3(32,6,t.venda.finalPrice,"BRL"),""),u.xp6(4),u.Q6J("icon",t.faPlus))},directives:[f._Y,f.JL,f.F,f.EJ,f.JJ,f.On,o.sg,f.YN,f.Kr,m.BN,f.qQ,f.wV,f.Fj,o.O5],pipes:[o.H9],styles:[".container[_ngcontent-%COMP%]{padding:30px}.container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;width:100%;background-color:#9364f1;padding:5px}.container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-size:25px;margin:10px 0}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{padding:50px;justify-content:center;display:flex;align-items:center;flex-direction:column}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:20px 0}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:bold;margin-bottom:10px;color:#534962}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background:#fff;width:340px;border-radius:15px;box-shadow:none;outline:none;border:1px solid #9671f1;font-size:16px;padding:15px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding-right:15px;width:370px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   .formGroupMoney[_ngcontent-%COMP%]{display:flex}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   .formGroupMoney[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border:1px solid #9671f1;height:48px;border-right:none;border-radius:15px 0 0 15px;display:flex;align-items:center;padding:0 15px;font-size:20px;color:#fff;background:#9671f1}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup[_ngcontent-%COMP%]   .formGroupMoney[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100px;border-left:none;border-radius:0 15px 15px 0}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup2[_ngcontent-%COMP%]{display:flex;grid-column-gap:50px;-moz-column-gap:50px;column-gap:50px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .formGroup2[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .btnDiv[_ngcontent-%COMP%]{display:flex;grid-column-gap:50px;-moz-column-gap:50px;column-gap:50px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .btnSubmit[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin-top:2rem;border:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;background:#ccd1ff;color:#5e17eb;border-radius:50px;font-size:20px;cursor:pointer;padding:16px 40px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .btnDelete[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin-top:2rem;border:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;background:#ff4646;color:#fff;border-radius:50px;font-size:20px;cursor:pointer;padding:16px 40px}.sub-title[_ngcontent-%COMP%]{text-align:center;width:50%;background-color:#9364f1;padding:5px;margin:30px auto 0}.sub-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-size:18px;margin:5px 0}.btnDivAdd[_ngcontent-%COMP%]{justify-content:end}.btnDivAdd[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:15px!important;padding:11px!important}.formGroup2[_ngcontent-%COMP%]{align-items:center}.removeProd[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin-top:2rem;border:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;background:#ccd1ff;color:#5e17eb;border-radius:50px;font-size:20px;cursor:pointer;font-size:15px;padding:13px}.vpPrice[_ngcontent-%COMP%]{height:50px;vertical-align:middle;line-height:50px;text-align:center}.total[_ngcontent-%COMP%]{text-align:right}"]}),n})(),v=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[l.$,s.m,p.O],imports:[[o.ez,g.Bz.forChild([{path:"",component:_}]),f.u5,m.uH]]}),n})()}}]);